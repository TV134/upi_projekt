<!DOCTYPE html>
<html lang="hr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Svemirska Memorijska Orbita</title>
    <style>
        :root {
            /* Text Colors */
            --text-color: #ffffff;
            --neon-blue: #00d2ff;
            --neon-gold: #ffd700;
        }

        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            width: 100vw;
            /* Default Deep Space Background */
            background: linear-gradient(135deg, #050a14, #000000);
            background-size: 400% 400%;
            font-family: "Comic Sans MS", "Comic Sans", "Chalkboard SE", cursive;
            /* Requested Font */
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            user-select: none;
            touch-action: manipulation;
            /* Improves touch response */
            transition: all 1s ease;
        }

        /* Moving Background Animation */
        @keyframes bgMove {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        /* --- PLANET THEMES --- */
        body.planet-1 {
            /* Deep Space */
            background: linear-gradient(135deg, #0f1626, #000000);
            background-size: 400% 400%;
            animation: bgMove 15s ease infinite;
        }

        body.planet-2 {
            /* Mars Orbit (Red/Brown) */
            background: linear-gradient(135deg, #4a1c1c, #8a3c1c, #2c0e0e);
            background-size: 400% 400%;
            animation: bgMove 15s ease infinite;
        }

        body.planet-3 {
            /* Jupiter Gas (Swirly Orange/Purple) */
            background: linear-gradient(135deg, #5e2c5e, #cbaacb, #5e2c5e);
            background-size: 400% 400%;
            animation: bgMove 12s ease infinite;
        }

        body.planet-4 {
            /* Neptune Ice (Cyan/Blue) */
            background: linear-gradient(135deg, #003366, #00ccff, #003366);
            background-size: 400% 400%;
            animation: bgMove 15s ease infinite;
        }

        body.planet-5 {
            /* Golden Core (Gold/Black) */
            background: linear-gradient(135deg, #b8860b, #ffd700, #000000);
            background-size: 400% 400%;
            animation: bgMove 10s ease infinite;
        }

        /* Twinkling stars background (Overlay on top of gradient) */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            background-image:
                radial-gradient(white, rgba(255, 255, 255, .2) 2px, transparent 3px),
                radial-gradient(white, rgba(255, 255, 255, .15) 1px, transparent 2px);
            background-size: 550px 550px, 350px 350px;
            background-position: 0 0, 40px 60px;
            opacity: 0.8;
        }

        /* Moving Attractions (Asteroids, Comets) */
        .attraction {
            position: absolute;
            pointer-events: none;
            opacity: 0.6;
            z-index: -1;
        }

        .asteroid-float {
            font-size: 3rem;
            animation: floatAcross 20s linear infinite;
        }

        .comet-fly {
            font-size: 2rem;
            animation: flyComet 8s ease-in infinite;
            filter: drop-shadow(-10px 0 10px rgba(255, 255, 255, 0.5));
        }

        @keyframes floatAcross {
            0% {
                transform: translate(-10vw, 10vh) rotate(0deg);
            }

            100% {
                transform: translate(110vw, 50vh) rotate(360deg);
            }
        }

        @keyframes flyComet {
            0% {
                transform: translate(110vw, -10vh) scale(0.5);
                opacity: 0;
            }

            10% {
                opacity: 1;
            }

            100% {
                transform: translate(-20vw, 110vh) scale(1.5);
                opacity: 0;
            }
        }

        h1 {
            font-size: clamp(2rem, 5vw, 3rem);
            margin-bottom: 10px;
            text-align: center;
            color: var(--neon-blue);
            text-shadow: 0 0 15px var(--neon-blue);
            margin-top: 0;
            width: 90%;
            z-index: 50;
        }

        .game-container {
            position: relative;
            width: 380px;
            height: 380px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Spaceship */
        .spaceship {
            font-size: 7rem;
            /* Bigger spaceship */
            z-index: 10;
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            filter: drop-shadow(0 0 15px rgba(0, 200, 255, 0.6));
            cursor: pointer;
        }

        .spaceship:active {
            transform: scale(0.95);
        }

        /* Orbs layout with planet look */
        .orb {
            position: absolute;
            width: 100px;
            /* Bigger orbs */
            height: 100px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), filter 0.2s;
            opacity: 0.95;
            box-shadow: inset -15px -15px 30px rgba(0, 0, 0, 0.6), 0 0 20px rgba(255, 255, 255, 0.2);
            border: 3px solid rgba(255, 255, 255, 0.3);
            -webkit-tap-highlight-color: transparent;
            z-index: 20;
        }

        /* Removed complex transforms on active, just scale */
        .orb:active {
            transform: scale(0.9);
        }

        /* When Input is Blocked */
        .orbs-blocked .orb {
            cursor: default;
            opacity: 0.8;
            /* Less dim to keep it pretty */
            filter: grayscale(0.3);
            /* pointer-events removed here to allow 'click' sound on disabled if we wanted, 
               but strictly for game logic we handle it in JS. 
               User complained about clicks not registering, so we will be lenient visually but strict logically.
            */
        }

        /* Positioning - Increased distance slightly */
        .orb.top {
            top: 0px;
            left: 50%;
            margin-left: -50px;
            /* Center manually with margin instead of translate for stability */
            background: radial-gradient(circle at 30% 30%, #ff8888, #aa0000);
        }

        .orb.bottom {
            bottom: 0px;
            left: 50%;
            margin-left: -50px;
            background: radial-gradient(circle at 30% 30%, #88ff88, #00aa00);
        }

        .orb.left {
            left: 0px;
            top: 50%;
            margin-top: -50px;
            background: radial-gradient(circle at 30% 30%, #8888ff, #0000aa);
        }

        .orb.right {
            right: 0px;
            top: 50%;
            margin-top: -50px;
            background: radial-gradient(circle at 30% 30%, #ffff88, #aaaa00);
        }

        /* Active state for blinking - SCALING ONLY */
        .orb.active {
            filter: brightness(2) drop-shadow(0 0 50px currentColor);
            transform: scale(1.3);
            /* Big scale up */
            z-index: 30;
            border-color: white;
            opacity: 1;
        }

        .status-text {
            margin-top: 10px;
            font-size: 2rem;
            text-align: center;
            min-height: 1.5em;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
            font-weight: bold;
            z-index: 50;
        }

        .level-display {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--neon-gold);
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
            z-index: 50;
        }

        /* Particle Effects */
        .particle {
            position: absolute;
            pointer-events: none;
            background: white;
            border-radius: 50%;
            animation: particleAnim 0.6s ease-out forwards;
            z-index: 50;
        }

        @keyframes particleAnim {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }

        /* Overlay Cards */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(8px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .card {
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid #00d2ff;
            border-radius: 50%;
            /* Circle shape */
            width: 450px;
            height: 450px;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 0 60px rgba(0, 210, 255, 0.5), inset 0 0 40px rgba(0, 0, 0, 0.8);
            position: relative;
            animation: popIn 0.5s;
        }

        /* Rotating ring around modal */
        .card::before {
            content: "";
            position: absolute;
            top: -20px;
            left: -20px;
            right: -20px;
            bottom: -20px;
            border: 2px dashed rgba(0, 210, 255, 0.3);
            border-radius: 50%;
            animation: spinSlow 20s linear infinite;
            z-index: -1;
        }

        @keyframes spinSlow {
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes popIn {
            0% {
                transform: scale(0.5);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .card h2 {
            color: var(--neon-gold);
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-transform: uppercase;
            margin-top: 0;
        }

        .tutorial-step {
            margin-bottom: 15px;
            font-size: 1.5rem;
            line-height: 1.5;
            color: #fff;
            text-align: left;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .tutorial-step span {
            flex: 1;
        }

        .btn-start {
            margin-top: 20px;
            padding: 15px 40px;
            font-size: 2rem;
            background: #2ecc71;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            font-weight: bold;
            box-shadow: 0 6px 0 #27ae60;
            transition: transform 0.1s;
        }

        .btn-start:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #27ae60;
        }

        /* Floating Attractions Containers */
        #background-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }
    </style>
</head>

<body class="planet-1">

    <div class="stars"></div>
    <div id="background-effects">
        <div class="attraction asteroid-float" style="top: 20%; left: -10%;">ü™®</div>
        <div class="attraction comet-fly" style="top: 10%; right: -10%; animation-delay: 5s;">‚òÑÔ∏è</div>
    </div>

    <!-- Return Button -->
    <a href="../galaxy.html"
        style="position: absolute; top: 15px; left: 15px; text-decoration: none; font-size: 1.2rem; background: rgba(255, 255, 255, 0.1); padding: 10px 20px; border-radius: 30px; border: 2px solid #00d2ff; color: #00d2ff; transition: 0.2s; box-shadow: 0 0 10px rgba(0, 210, 255, 0.3); z-index: 100; font-weight: bold;"
        onmouseover="this.style.transform='scale(1.05)'; this.style.background='rgba(255, 255, 255, 0.2)'"
        onmouseout="this.style.transform='scale(1)'; this.style.background='rgba(255, 255, 255, 0.1)'">
        ‚¨Ö POVRATAK
    </a>

    <button onclick="showInstructions()"
        style="position: absolute; top: 15px; right: 15px; background: rgba(0, 210, 255, 0.1); border: 2px solid #00d2ff; color: #00d2ff; padding: 10px 20px; border-radius: 30px; font-size: 1.1rem; font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 10px; transition: 0.2s; z-index: 100;"
        onmouseover="this.style.transform='scale(1.05)'; this.style.background='rgba(0, 210, 255, 0.2)'"
        onmouseout="this.style.transform='scale(1)'; this.style.background='rgba(0, 210, 255, 0.1)'">
        ‚ùì UPUTE
    </button>

    <h1>Svemirska Memorijska Orbita</h1>
    <div class="level-display" id="levelDisplay">RAZINA: 1</div>
    <div id="scoreText"
        style="font-size: 1.8rem; color: #ffd700; font-weight: bold; margin-bottom: 20px; text-shadow: 0 0 10px rgba(255, 215, 0, 0.4); z-index: 50;">
        BODOVI: 0</div>
    <div class="status-text" id="statusText">...</div>

    <div class="game-container" id="gameContainer">
        <!-- Spaceship Center -->
        <div class="spaceship hover-float" id="spaceship">üöÄ</div>

        <!-- Orbs - Simplified positioning -->
        <div class="orb top" id="orb-0" data-index="0" data-color="#ff4444"></div>
        <div class="orb right" id="orb-1" data-index="1" data-color="#ffff44"></div>
        <div class="orb bottom" id="orb-2" data-index="2" data-color="#44ff44"></div>
        <div class="orb left" id="orb-3" data-index="3" data-color="#4444ff"></div>
    </div>

    <!-- TUTORIAL OVERLAY -->
    <div class="overlay" id="tutorial-overlay" style="display: flex;">
        <div class="card" style="border: 4px solid var(--neon-blue);">
            <h2 id="tutorial-title" style="color: var(--neon-gold);">UPUTE</h2>
            <div id="tutorial-content" style="text-align: left; margin: 20px 0; color: #fff; font-size: 1.2rem;">
                <!-- Content injected by JS -->
            </div>
            <button class="btn-start" id="tutorial-main-btn" onclick="closeInstructions()">RAZUMIJEM! üöÄ</button>
        </div>
    </div>

    <!-- MESSAGE OVERLAY -->
    <div class="overlay" id="messageOverlay" style="display: none;">
        <div class="card">
            <h2 id="overlayTitle"></h2>
            <div class="tutorial-step" id="overlayMessage"
                style="text-align: center; background: none; display: block;">
            </div>
            <button class="btn-start" id="overlayBtn" onclick="resetGame()">IGRAJ PONOVO</button>
        </div>
    </div>

    <script src="../../game_storage.js"></script>
    <script>
        const orbs = document.querySelectorAll('.orb');
        const spaceship = document.getElementById('spaceship');
        const statusText = document.getElementById('statusText');
        const levelDisplay = document.getElementById('levelDisplay');
        const startOverlay = document.getElementById('startOverlay');
        const messageOverlay = document.getElementById('messageOverlay');
        const overlayTitle = document.getElementById('overlayTitle');
        const overlayMessage = document.getElementById('overlayMessage');
        const gameContainer = document.getElementById('gameContainer');

        let sequence = [];
        let playerSequence = [];
        let level = 1;

        const GAME_ID = 'orbit_game';
        let totalScore = 0;
        let highScore = 0;

        // Initialize high score safely
        try {
            if (typeof GameStorage !== 'undefined') {
                highScore = GameStorage.getHighScore(GAME_ID);
            }
        } catch (e) {
            console.log("GameStorage not found");
        }

        let isInputBlocked = true;

        let audioCtx = null;
        const orbFreqs = [261.63, 329.63, 392.00, 523.25]; // C E G C

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }

        function playTone(freq, type = 'sine', duration = 0.3) {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);

            gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);

            osc.connect(gain);
            gain.connect(audioCtx.destination);

            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        // --- Tutorial Logic ---
        function showInstructions() {
            const overlay = document.getElementById('tutorial-overlay');
            const title = document.getElementById('tutorial-title');
            const content = document.getElementById('tutorial-content');
            const btn = document.getElementById('tutorial-main-btn');

            title.innerText = "üéì UPUTE";
            content.innerHTML =
                `<div class="tutorial-step">üöÄ <span><strong>MISIJA:</strong> Putujemo kroz galaksiju!</span></div>` +
                `<div class="tutorial-step">üí° <span><strong>KAKO:</strong> Pamti redoslijed boja planeta i ponovi ih.</span></div>`;

            btn.innerText = "NASTAVI üöÄ";
            btn.onclick = closeInstructions;

            overlay.style.display = 'flex';
        }

        function closeInstructions() {
            document.getElementById('tutorial-overlay').style.display = 'none';
        }

        function showStartScreen() {
            const overlay = document.getElementById('tutorial-overlay');
            const title = document.getElementById('tutorial-title');
            const content = document.getElementById('tutorial-content');
            const btn = document.getElementById('tutorial-main-btn');

            title.innerHTML = "PLAN LETA<br><span style='font-size:1.5rem; opacity:0.7'>STATUS: SPREMAN</span>";
            title.style.color = "#00d2ff";

            content.innerHTML =
                `<div class="tutorial-step" style="background:transparent; justify-content:center;">
                    üåç <span><strong>MISIJA:</strong> Memoriraj orbitu.</span>
                 </div>` +
                `<div class="tutorial-step" style="background:transparent; justify-content:center;">
                    üëÜ <span><strong>KONTROLE:</strong> Prati signal.</span>
                 </div>`;

            btn.innerText = "LANSIRAJ üöÄ";
            btn.style.borderRadius = "50px";
            btn.style.padding = "20px 40px";
            btn.style.marginTop = "20px";
            btn.onclick = () => {
                closeInstructions();
                startGame();
            };

            overlay.style.display = 'flex';
        }

        function playSoundEffect(type) {
            if (!audioCtx) return;
            if (type === 'error') {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(50, audioCtx.currentTime + 0.5);
                gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else if (type === 'success') {
                playTone(523.25, 'triangle', 0.1);
                setTimeout(() => playTone(659.25, 'triangle', 0.1), 100);
                setTimeout(() => playTone(783.99, 'triangle', 0.3), 200);
            } else if (type === 'warp') {
                // Swoosh sound for travel
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.frequency.setValueAtTime(200, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(800, audioCtx.currentTime + 1);
                gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
                gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 1);
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start();
                osc.stop(audioCtx.currentTime + 1);
            }
        }

        function createParticles(x, y, color) {
            for (let i = 0; i < 15; i++) {
                const p = document.createElement('div');
                p.classList.add('particle');
                document.body.appendChild(p);

                const size = Math.random() * 10 + 5;
                p.style.width = size + 'px';
                p.style.height = size + 'px';
                p.style.backgroundColor = color;
                p.style.left = x + 'px';
                p.style.top = y + 'px';

                const angle = Math.random() * Math.PI * 2;
                const dist = Math.random() * 80 + 20;
                const tx = Math.cos(angle) * dist + 'px';
                const ty = Math.sin(angle) * dist + 'px';

                p.style.setProperty('--tx', tx);
                p.style.setProperty('--ty', ty);

                setTimeout(() => p.remove(), 600);
            }
        }

        function setInputBlocked(blocked) {
            isInputBlocked = blocked;
            if (blocked) {
                gameContainer.classList.add('orbs-blocked');
            } else {
                gameContainer.classList.remove('orbs-blocked');
            }
        }

        function nextPlanetTheme() {
            // Remove previous planet classes
            document.body.className = '';
            // Add new class (1 to 5)
            const themeIndex = ((level - 1) % 5) + 1;
            document.body.classList.add(`planet-${themeIndex}`);
        }

        function startGame() {
            initAudio();
            messageOverlay.style.display = 'none';

            sequence = [];
            playerSequence = [];
            level = 1;

            nextPlanetTheme(); // Reset to planet 1
            spaceship.classList.remove('launching');
            spaceship.style.transform = 'translate(0,0)';
            spaceship.style.opacity = '1';

            updateLevelDisplay();
            statusText.innerText = "Pripremi se...";

            setTimeout(nextRound, 1000);
        }

        function resetGame() {
            messageOverlay.style.display = 'none';
            startGame();
        }

        function updateLevelDisplay() {
            levelDisplay.innerText = `RAZINA: ${level}`;
        }

        function nextRound() {
            playerSequence = [];
            setInputBlocked(true);
            updateLevelDisplay();
            statusText.innerText = `PAMTI BOJE...`;
            statusText.style.color = "#ffd700";

            const randomOrb = Math.floor(Math.random() * 4);
            sequence.push(randomOrb);

            setTimeout(playSequence, 1000);
        }

        function playSequence() {
            let i = 0;
            const interval = setInterval(() => {
                activateOrb(sequence[i], true);
                i++;
                if (i >= sequence.length) {
                    clearInterval(interval);
                    setTimeout(() => {
                        statusText.innerText = "TVOJ RED!";
                        statusText.style.color = "#44ff44";
                        setInputBlocked(false); // ENABLE INPUT
                    }, 500);
                }
            }, 900);
        }

        function activateOrb(index, isAuto = false) {
            const orb = document.getElementById(`orb-${index}`);
            orb.classList.add('active');
            playTone(orbFreqs[index]);

            if (!isAuto) {
                const rect = orb.getBoundingClientRect();
                createParticles(rect.left + rect.width / 2, rect.top + rect.height / 2, orb.dataset.color);
            }

            setTimeout(() => {
                orb.classList.remove('active');
            }, 300);
        }

        // --- CLICK HANDLER ---
        // Using 'pointerdown' for faster reaction than click
        orbs.forEach(orb => {
            orb.addEventListener('pointerdown', (e) => {
                e.preventDefault(); // Prevent ghost clicks
                if (isInputBlocked) return;

                const index = parseInt(e.target.dataset.index);
                activateOrb(index);
                playerSequence.push(index);

                checkMove(playerSequence.length - 1);
            });
        });

        function checkMove(currentIndex) {
            if (playerSequence[currentIndex] !== sequence[currentIndex]) {
                gameOver();
                return;
            }

            if (playerSequence.length === sequence.length) {
                levelComplete();
            }
        }

        function levelComplete() {
            setInputBlocked(true);
            statusText.innerText = "SUPER! PUTUJEMO DALJE...";
            playSoundEffect('success');

            totalScore += 10;
            document.getElementById('scoreText').innerText = `BODOVI: ${totalScore}`;
            if (typeof GameStorage !== 'undefined') {
                GameStorage.addCredits(10);
                if (totalScore > highScore) {
                    highScore = totalScore;
                    GameStorage.saveHighScore(GAME_ID, highScore);
                }
            }

            if (level === 5) {
                victory();
            } else {
                level++;

                // --- LEVEL UP ANIMATION ---
                // 1. Rocket flies out
                spaceship.style.transform = "scale(1.5) translateY(-50px)";
                playSoundEffect('warp');

                // 2. Background changes mid-flight
                setTimeout(() => {
                    spaceship.style.transition = "transform 0.5s ease-in";
                    spaceship.style.transform = "scale(0) translateY(-500px)"; // Zip out
                }, 500);

                setTimeout(() => {
                    nextPlanetTheme();
                }, 1000);

                // 3. Reset and continues
                setTimeout(() => {
                    spaceship.style.transition = "none";
                    spaceship.style.transform = "translateY(500px)"; // Reset pos
                    setTimeout(() => {
                        spaceship.style.transition = "transform 1s cubic-bezier(0.175, 0.885, 0.32, 1.275)";
                        spaceship.style.transform = "translate(0,0)"; // Zip in
                        nextRound();
                    }, 100);
                }, 2000);
            }
        }

        function gameOver() {
            setInputBlocked(true);
            statusText.innerText = "KRIVI PLANET!";
            statusText.style.color = "#ff4444";
            playSoundEffect('error');

            setTimeout(() => {
                overlayTitle.innerText = "UPS!";
                overlayTitle.style.color = "#ff4444";
                overlayMessage.innerHTML = "To nije bio toƒçan redoslijed.<br>Izgubili smo se u svemiru.";
                document.getElementById('overlayBtn').innerText = "POKU≈†AJ PONOVO";
                messageOverlay.style.display = 'flex';
            }, 800);
        }

        function victory() {
            statusText.innerText = "STIGLI SMO NA CILJ!";

            spaceship.classList.add('launching');
            const rect = spaceship.getBoundingClientRect();
            createParticles(rect.left + rect.width / 2, rect.top + rect.height / 2 + 40, '#ff4400');
            createParticles(rect.left + rect.width / 2, rect.top + rect.height / 2 + 40, '#ffd700');

            setTimeout(() => {
                overlayTitle.innerText = "MISIJA USPJE≈†NA!";
                overlayTitle.style.color = "#2ecc71";
                overlayMessage.innerHTML = "ƒåestitam! Istra≈æili smo cijelu galaksiju!";
                document.getElementById('overlayBtn').innerText = "IGRAJ PONOVO";
                messageOverlay.style.display = 'flex';
            }, 3000);
        }

    </script>
    </script>
    <script>
        showStartScreen();
    </script>
</body>

</html>